{% extends "base.html" %}
{% block content %}
<h1>Login</h1>
<form id="login-form">
  <label>Email:</label><br>
  <input type="email" name="email" required><br>
  <label>Password:</label><br>
  <input type="password" name="password" required><br><br>
  <button type="submit">Login</button>
</form>
<p>Don't have an account? <a href="{{ url_for('auth.register_page') }}">Register here.</a></p>
<script>
document.getElementById("login-form").addEventListener("submit", async function(e) {
  e.preventDefault();
  const form = new FormData(e.target);
  const data = { email: form.get("email"), password: form.get("password") };

  const response = await fetch("/auth/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });

  const result = await response.json();

  if (result.message) {
    alert(result.message);
    // redirects to index
    window.location.href = "/";
  } else {
    alert(result.error);
  }
});
</script>
{% endblock %}
