{% extends "base.html" %}
{% block content %}
<h1>Register</h1>
<form id="register-form">
  <label>Username:</label><br>
  <input type="text" name="username" required><br>
  <label>Email:</label><br>
  <input type="email" name="email" required><br>
  <label>Password:</label><br>
  <input type="password" name="password" required><br><br>
  <button type="submit">Register</button>
</form>

<script>
document.getElementById("register-form").addEventListener("submit", async function(e) {
  e.preventDefault();
  const form = new FormData(e.target);
  const data = {
    username: form.get("username"),
    email: form.get("email"),
    password: form.get("password")
  };

  const response = await fetch("/auth/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });

  const result = await response.json();

  if (response.ok) {
    // ✅ Registration success → redirect to login page
    alert(result.message || "Registration successful!");
    window.location.href = "/auth/login";
  } else {
    // ❌ Show error if backend responded with an error
    alert(result.error || "Registration failed.");
  }
});
</script>
{% endblock %}

